<div class="container">
  <header class="header">
    <h1>â˜ï¸ CloudVote</h1>
    <p class="subtitle">Votez pour votre Fournisseur cloud prÃ©fÃ©rÃ©</p>
  </header>

  <nav class="navigation">
    <button 
      class="nav-btn" 
      [class.active]="currentView === 'vote'"
      (click)="switchView('vote')">
      ğŸ—³ï¸ Voter
    </button>
    <button 
      class="nav-btn" 
      [class.active]="currentView === 'results'"
      (click)="switchView('results')">
      ğŸ“Š RÃ©sultats
    </button>
  </nav>

  <!-- Page de vote -->
  <div class="content" *ngIf="currentView === 'vote'">
    <h2 class="section-title">Choisissez votre fournisseur favori</h2>
    
    <div class="projects-grid">
      @for (p of projects; track p.id) {
        <div class="project-card">
          <div class="project-logo">
            <img [src]="p.logo_url" [alt]="p.name">
          </div>
          <div class="project-info">
            <h3 class="project-name">{{ p.name }}</h3>
          </div>
          <button class="vote-btn" (click)="vote(p.id)">
            <span>ğŸ‘</span> Voter
          </button>
        </div>
      }
    </div>

    @if (projects.length === 0) {
      <div class="empty-state">
        <p>Aucun fournisseur disponible pour le moment.</p>
      </div>
    }
  </div>

  <!-- Page de rÃ©sultats -->
  <div class="content" *ngIf="currentView === 'results'">
    <h2 class="section-title">RÃ©sultats en temps rÃ©el</h2>
    
    <div class="results-summary">
      <div class="stat-card">
        <div class="stat-value">{{ getTotalVotes() }}</div>
        <div class="stat-label">Votes totaux</div>
      </div>
      <div class="stat-card">
        <div class="stat-value">{{ results.length }}</div>
        <div class="stat-label">FOURNISSEURS</div>
      </div>
    </div>

    <div class="results-list">
      @for (result of results; track result.project_id; let idx = $index) {
        <div class="result-card" [class.winner]="idx === 0">
          <div class="result-rank">
            @if (idx === 0) {
              <span class="trophy">ğŸ†</span>
            } @else if (idx === 1) {
              <span class="medal">ğŸ¥ˆ</span>
            } @else if (idx === 2) {
              <span class="medal">ğŸ¥‰</span>
            } @else {
              <span class="rank-number">{{ idx + 1 }}</span>
            }
          </div>
          
          <div class="result-info">
            <h3 class="result-name">{{ result.name }}</h3>
            <div class="result-bar-container">
              <div 
                class="result-bar" 
                [style.width.%]="getPercentage(result.votes)"
                [class.leader]="idx === 0">
              </div>
            </div>
            <div class="result-stats">
              <span class="votes-count">{{ result.votes }} vote{{ result.votes > 1 ? 's' : '' }}</span>
              <span class="percentage">{{ getPercentage(result.votes).toFixed(1) }}%</span>
            </div>
          </div>
        </div>
      }
    </div>

    @if (results.length === 0) {
      <div class="empty-state">
        <p>Aucun vote enregistrÃ© pour le moment.</p>
        <button class="cta-btn" (click)="switchView('vote')">
          Soyez le premier Ã  voter !
        </button>
      </div>
    }
  </div>
</div>